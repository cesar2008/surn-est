SET DATE BRITISH
CLEAR


DO PASAR WITH "REM2"
DO PASAR WITH "FACA2"
DO PASAR WITH "FACB2"


QUIT



**********

PROC PASAR

**********
PARAMETERS base

? base
base = base + ".DBF"
USE &base
DECLARE aaux[FCOUNT()]
AFIELDS(aaux)
CLOSE DATABASES
IF ASCAN(aaux,"TIMPINT") = 0
	ERASE QQ.DBF
	RENAME &base TO QQ.DBF
  IF "REM" $ base
		COPY FILE REMBIEN.DBF TO &base
     cCampo = "NUMFAC"
  ELSE
		COPY FILE FACBIEN.DBF TO &base
     cCampo = "NUMFAC"
  ENDIF
ELSE
	RETURN
ENDIF

SELECT 1
USE &base ALIAS F2

SELECT 2
USE QQ ALIAS Q
GO TOP
R=ROW()
@ R,0 SAY LASTREC()
R=R+1


SELECT F2
ZAP
DO WHILE !Q->(EOF())
	APPEND BLANK
  REPLACE  F2->&cCampo WITH Q->&cCampo,;
           F2->CODPROD WITH Q->CODPROD,;
  			F2->DESCPROD WITH Q->DESCPROD,;
  			F2->CANTIDAD WITH Q->CANTIDAD,;
           F2->TPRECBASE WITH Q->PRECBASE*Q->CANTIDAD,;
           F2->TIVA1 WITH F2->TPRECBASE*18/100,;
           F2->TIMPINT WITH Q->IMPINT*Q->CANTIDAD,;
           F2->PRECUNIT WITH Q->PRECBASE+Q->IMPINT+Q->PRECBASE*18/100,;
           F2->IMPORTE WITH Q->PRECUNIT*F2->CANTIDAD
	@ R,0 SAY F2->(LASTREC())
  SKIP 1 ALIAS Q
ENDDO

RETURN
